<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Media Control Centre</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=JetBrains+Mono:wght@400;700&display=swap');
        
        :root {
            --cmd-red: #ff003c;
            --cmd-cyan: #00f2ff;
            --cmd-bg: #050505;
        }

        body {
            background-color: var(--cmd-bg);
            color: #e5e5e5;
            font-family: 'JetBrains Mono', monospace;
            overflow: hidden;
            transition: outline 0.3s ease;
            outline: 0px solid var(--cmd-red);
            outline-offset: -10px;
        }

        /* Tactical Freeze Effect */
        body.paused {
            outline: 10px solid var(--cmd-red);
        }

        .heading-font { font-family: 'Orbitron', sans-serif; }

        .scanlines {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.03), rgba(0, 255, 0, 0.01), rgba(0, 0, 255, 0.03));
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
            z-index: 100;
        }

        .crt-glow {
            text-shadow: 0 0 8px rgba(255, 0, 60, 0.6);
        }

        .grid-bg {
            background-image: radial-gradient(#1a1a1a 1px, transparent 1px);
            background-size: 30px 30px;
        }

        .btn-cmd {
            border: 1px solid var(--cmd-red);
            background: rgba(255, 0, 60, 0.1);
            transition: all 0.2s ease;
        }

        .btn-cmd:hover {
            background: var(--cmd-red);
            color: white;
            box-shadow: 0 0 20px var(--cmd-red);
        }

        .nav-btn {
            @apply px-4 py-2 border border-zinc-700 text-zinc-500 hover:text-white hover:border-white transition-all text-[10px] heading-font uppercase tracking-widest;
        }

        @keyframes glitch {
            0% { transform: translate(0); }
            20% { transform: translate(-2px, 2px); }
            40% { transform: translate(-2px, -2px); }
            60% { transform: translate(2px, 2px); }
            80% { transform: translate(2px, -2px); }
            100% { transform: translate(0); }
        }

        .glitch-text { animation: glitch 0.2s infinite alternate; }
    </style>
</head>
<body class="h-screen flex flex-col items-center justify-center p-8 grid-bg">
    <div class="scanlines"></div>

    <!-- UI Top Header -->
    <div id="ui-header" class="fixed top-0 left-0 w-full p-6 flex justify-between items-center z-[110] border-b border-zinc-800 bg-black/80 backdrop-blur-sm hidden">
        <div class="flex items-center gap-4">
            <div id="status-light" class="w-2 h-2 bg-red-600 animate-pulse"></div>
            <h1 class="heading-font text-lg tracking-widest text-zinc-400">SEM MEDIA-CONT ISS // MEDIA CONTROL</h1>
            <div id="pause-indicator" class="hidden ml-4 px-3 py-1 bg-red-600 text-white text-[10px] font-black uppercase tracking-widest animate-pulse">
                System Paused
            </div>
        </div>
        
        <div class="flex items-center gap-6">
            <button id="pause-btn" onclick="togglePause()" class="flex items-center gap-3 px-4 py-2 bg-zinc-900 border border-zinc-700 rounded hover:border-white transition-all">
                <div id="pause-icon" class="w-3 h-3 bg-white"></div>
                <span id="pause-text" class="text-[10px] uppercase font-bold heading-font tracking-widest">Pause [Space]</span>
            </button>

            <button onclick="toggleFullScreen()" class="px-3 py-2 border border-zinc-700 rounded text-[10px] uppercase font-bold text-zinc-400 hover:bg-white hover:text-black transition-all">
                Full Screen [F]
            </button>
            
            <div class="text-right border-l border-zinc-800 pl-6">
                <div class="text-[10px] text-zinc-500 uppercase tracking-tighter">Mission Clock</div>
                <div id="global-timer" class="heading-font text-3xl text-red-600">10:00</div>
            </div>
        </div>
    </div>

    <!-- Main Display -->
    <main id="game-stage" class="w-full max-w-6xl h-full flex items-center justify-center relative z-10">
        
        <!-- START SCREEN -->
        <div id="screen-start" class="text-center space-y-8">
            <h1 class="heading-font text-7xl font-black tracking-tighter leading-none mb-4 crt-glow italic">MEDIA <br> CONTROL <br> CENTRE</h1>
            <p class="text-zinc-500 text-lg uppercase tracking-widest max-w-2xl mx-auto">
                System online. Audio initialised. <br> 
                Prepare to engage in 4 rounds of media ethics. <br>
                Ready? Get set. Decide!
            </p>
            <button onclick="startGame()" class="px-12 py-4 btn-cmd heading-font text-2xl uppercase tracking-widest text-red-500 font-bold">
                Enter Command Centre
            </button>
        </div>

        <!-- TRANSITION SCREEN (5s Countdown) -->
        <div id="screen-transition" class="hidden text-center space-y-6">
            <h2 class="heading-font text-2xl text-zinc-500 uppercase tracking-[0.3em]">Next Deployment</h2>
            <div id="transition-timer" class="heading-font text-[18rem] leading-none text-white font-black italic">5</div>
            <div class="bg-red-600 text-white px-8 py-2 heading-font text-xl animate-pulse tracking-widest">PASS THE BALL</div>
            <div class="flex justify-center gap-4 mt-8">
                <button onclick="manualPrev()" class="nav-btn">Back</button>
                <button onclick="manualNext()" class="nav-btn">Skip</button>
            </div>
        </div>

        <!-- SURPRISE SCREEN -->
        <div id="screen-surprise" class="hidden w-full max-w-3xl text-center space-y-10">
            <div class="inline-block px-10 py-3 bg-white text-black heading-font font-black text-4xl uppercase skew-x-[-12deg] italic glitch-text">
                ALERT!
            </div>
            <div class="flex flex-col items-center gap-8 py-12 border-y border-zinc-800">
                <div id="surprise-icon-container" class="text-9xl">ðŸ”„</div>
                <p id="surprise-msg" class="heading-font text-4xl font-bold text-white uppercase leading-tight"></p>
            </div>
            <div class="flex justify-center gap-8">
                <button onclick="manualPrev()" class="nav-btn">Back</button>
                <button onclick="loadRound()" class="px-12 py-4 border border-white text-white hover:bg-white hover:text-black transition-all heading-font uppercase font-bold tracking-widest">
                    Accept Modification
                </button>
            </div>
        </div>

        <!-- ROUND CONTENT -->
        <div id="screen-round" class="hidden w-full space-y-8">
            <div class="flex justify-between items-end border-b-2 border-zinc-800 pb-4">
                <div>
                    <h3 id="round-number" class="text-red-600 heading-font font-bold tracking-widest">PHASE: 01</h3>
                    <h2 id="round-role" class="text-5xl heading-font font-black text-white italic uppercase">ROLE: JOURNALIST</h2>
                </div>
                <div class="text-right">
                    <span class="text-[10px] text-zinc-600 block uppercase font-bold tracking-widest">Phase Expiry</span>
                    <span id="round-timer" class="heading-font text-4xl font-bold text-zinc-300">02:00</span>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-start mt-12">
                <div class="space-y-6">
                    <div class="text-[10px] text-red-600 heading-font uppercase tracking-widest font-bold">Current Scenario</div>
                    <p id="scenario-text" class="text-2xl font-light leading-relaxed text-zinc-300 border-l-2 border-red-600 pl-8"></p>
                    <div class="pt-8">
                        <button onclick="manualPrev()" class="nav-btn">Back to Countdown</button>
                    </div>
                </div>
                <div id="choices-container" class="space-y-4"></div>
            </div>

            <!-- Analysis Modal -->
            <div id="analysis-container" class="hidden fixed inset-0 bg-[#111111] flex flex-col items-center justify-center p-12 z-[100] text-center border-t-8 border-red-600">
                <div class="w-full max-w-5xl space-y-8">
                    <div class="text-red-600 heading-font tracking-widest uppercase border-b border-zinc-800 pb-4 inline-block px-12">System Post-Action Analysis</div>
                    <p id="analysis-text" class="text-4xl md:text-5xl font-bold heading-font text-white leading-tight italic"></p>
                    <div id="analysis-timer" class="text-sm font-mono text-zinc-600 tracking-widest uppercase">Proceeding in <span class="text-red-500">20</span>s...</div>
                    <div class="flex justify-center gap-6 mt-12">
                        <button onclick="backToConsequence()" class="nav-btn">Back to Choices</button>
                        <button onclick="nextRound()" class="px-12 py-5 btn-cmd heading-font text-xl uppercase tracking-widest text-red-500 font-bold">
                            Advance Sequence
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- CONCLUSION SCREEN -->
        <div id="screen-conclusion" class="hidden text-center space-y-12 max-w-4xl">
            <h1 class="heading-font text-6xl font-black text-red-600 italic tracking-tighter">MISSION COMPLETE</h1>
            <div class="space-y-6 text-xl text-zinc-400 leading-relaxed max-w-2xl mx-auto">
                <p>In 10 minutes, we felt the tension of <span class="text-white font-bold underline italic">Speed vs Accuracy</span>.</p>
                <p>News is the result of many actorsâ€”journalists, platforms, governments, and audiencesâ€”interacting to keep information circulating.</p>
            </div>
            <div class="flex justify-center gap-4">
                <button onclick="manualPrev()" class="nav-btn">Back to Final Analysis</button>
                <button onclick="location.reload()" class="px-8 py-3 border border-zinc-700 text-zinc-600 hover:text-white transition-colors heading-font uppercase text-xs">Reboot Command Center</button>
            </div>
        </div>

    </main>

    <script>
        const ROUNDS = [
            {
                role: "THE JOURNALIST",
                scenario: "A video shows civilians injured in Gaza after an airstrike. Source is local. It cannot yet be independently verified.",
                choices: [
                    { id: 'A', text: "Publish now with disclaimer", consequence: "SPEED PRIORITISED: Traffic spikes, but your credibility is now linked to unverified data." },
                    { id: 'B', text: "Wait until full verification", consequence: "ACCURACY PRIORITISED: You have your integrity, but a competitor got 1M views before you spoke." }
                ],
                analysis: "Publishing prioritises speed and agenda-setting. Waiting prioritises credibility and gatekeeping. Journalism cannot maximise both at the same time."
            },
            {
                role: "THE PLATFORM",
                surprise: { text: "Reverse Card! Pass the ball back to whoever gave it to you!", icon: "ðŸ”„" },
                scenario: "The video is now viral. Millions are sharing. Emotions are high. Verification is still pending.",
                choices: [
                    { id: 'A', text: "Let it circulate freely", consequence: "VISIBILITY MAXIMISED: Engagement is through the roof, but outrage is fueling real-world tension." },
                    { id: 'B', text: "Add warning labels / reduce reach", consequence: "CURATION: You slowed the spread, but users are claiming 'censorship'." },
                    { id: 'C', text: "Temporarily remove it", consequence: "INTERVENTION: You stopped the spread, but caused a massive PR backlash about transparency." }
                ],
                analysis: "Platforms donâ€™t just host content â€” they shape visibility. Their decisions influence emotion, outrage, and political pressure."
            },
            {
                role: "THE GOVERNMENT",
                surprise: { text: "+2 Card! Give the ball to the person sitting 2 seats away!", icon: "+2ï¸âƒ£" },
                scenario: "International coverage is turning negative. Public opinion abroad is shifting against you.",
                choices: [
                    { id: 'A', text: "Issue statement immediately", consequence: "FRAME CONTROL: You occupy the media space, but facts may contradict you later." },
                    { id: 'B', text: "Delay and gather more info", consequence: "VACUUM: Your silence allows others to define the story as 'guilt'." },
                    { id: 'C', text: "Accuse media of bias", consequence: "DIVERSION: You consolidate your base, but lose all global diplomatic trust." }
                ],
                analysis: "Governments attempt frame controlâ€”not by facts alone, but by timing, language, and blame to influence the audience."
            },
            {
                role: "THE PUBLIC",
                scenario: "You see an emotional video vs. a long investigative article. Which one do you push out?",
                choices: [
                    { id: 'A', text: "Share emotional content", consequence: "AMPLIFIED: You shared the 'feeling', but possibly helped spread a partial truth." },
                    { id: 'B', text: "Share the article", consequence: "GHOSTED: The truth is deep, but the algorithm buried your share with 0 likes." },
                    { id: 'C', text: "Stay silent", consequence: "NEUTRALISED: You didn't spread lies, but you allowed the loudest voices to dominate." }
                ],
                analysis: "Audience behavior determines what survives in the media ecosystem. Attention is a form of power."
            }
        ];

        let currentRoundIndex = 0;
        let globalSeconds = 600;
        let roundSeconds = 120;
        let gameActive = false;
        let gamePaused = false;
        let audioContext, masterGain;
        let analysisInterval, transitionInterval, roundInterval, globalInterval;
        let currentCountdownValue = 5;
        let currentAnalysisValue = 20;

        // --- EXCITING ARCADE SYNTH AUDIO ENGINE ---
        function initAudio() {
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
            masterGain = audioContext.createGain();
            masterGain.connect(audioContext.destination);
            masterGain.gain.value = 0.3;
        }

        function playSynthNote(freq, time, duration = 0.2, type = 'square') {
            if (gamePaused) return;
            const osc = audioContext.createOscillator();
            const g = audioContext.createGain();
            osc.type = type;
            osc.frequency.setValueAtTime(freq, time);
            g.gain.setValueAtTime(0.15, time);
            g.gain.exponentialRampToValueAtTime(0.001, time + duration);
            osc.connect(g);
            g.connect(masterGain);
            osc.start(time);
            osc.stop(time + duration);
        }

        let musicLoop;
        function startExcitingMusic() {
            if (!audioContext) initAudio();
            clearInterval(musicLoop);
            
            const notes = [110, 110, 130.81, 146.83]; // A2, A2, C3, D3
            let step = 0;
            
            musicLoop = setInterval(() => {
                if (!gameActive || gamePaused) return;
                const now = audioContext.currentTime;
                playSynthNote(notes[step % notes.length], now, 0.15, 'square');
                if (step % 4 === 0) playSynthNote(440, now, 0.05, 'sine');
                step++;
            }, 200);
        }

        function playCommandBeep(isFinal = false) {
            if (!audioContext || gamePaused) return;
            const now = audioContext.currentTime;
            const osc = audioContext.createOscillator();
            const g = audioContext.createGain();
            osc.type = 'triangle';
            osc.frequency.setValueAtTime(isFinal ? 1500 : 1000, now);
            g.gain.setValueAtTime(0.2, now);
            g.gain.exponentialRampToValueAtTime(0.001, now + 0.3);
            osc.connect(g);
            g.connect(masterGain);
            osc.start();
            osc.stop(now + 0.3);
        }

        // --- PAUSE LOGIC (NO OVERLAY) ---
        function togglePause() {
            if (!gameActive && currentRoundIndex === 0) return;
            
            gamePaused = !gamePaused;
            const pBtn = document.getElementById('pause-btn');
            const pText = document.getElementById('pause-text');
            const pIcon = document.getElementById('pause-icon');
            const statusLight = document.getElementById('status-light');
            const pIndicator = document.getElementById('pause-indicator');

            if (gamePaused) {
                document.body.classList.add('paused');
                pIndicator.classList.remove('hidden');
                pBtn.classList.add('bg-white', 'border-white');
                pBtn.classList.remove('bg-zinc-900', 'border-zinc-700');
                pText.innerText = "Resume [Space]";
                pText.classList.add('text-black');
                pIcon.classList.add('bg-black');
                statusLight.classList.remove('bg-red-600', 'animate-pulse');
                statusLight.classList.add('bg-yellow-500');
            } else {
                document.body.classList.remove('paused');
                pIndicator.classList.add('hidden');
                pBtn.classList.remove('bg-white', 'border-white');
                pBtn.classList.add('bg-zinc-900', 'border-zinc-700');
                pText.innerText = "Pause [Space]";
                pText.classList.remove('text-black');
                pIcon.classList.remove('bg-black');
                statusLight.classList.add('bg-red-600', 'animate-pulse');
                statusLight.classList.remove('bg-yellow-500');
            }
        }

        // --- FLOW LOGIC ---
        function formatTime(s) {
            return `${Math.floor(s/60).toString().padStart(2, '0')}:${(s%60).toString().padStart(2, '0')}`;
        }

        function toggleFullScreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                if (document.exitFullscreen) document.exitFullscreen();
            }
        }

        function startGame() {
            document.getElementById('screen-start').classList.add('hidden');
            document.getElementById('ui-header').classList.remove('hidden');
            startExcitingMusic();
            
            globalInterval = setInterval(() => {
                if (globalSeconds > 0 && !gamePaused) {
                    globalSeconds--;
                    document.getElementById('global-timer').innerText = formatTime(globalSeconds);
                }
            }, 1000);
            
            startTransition();
        }

        function startTransition() {
            gameActive = false;
            const screenTrans = document.getElementById('screen-transition');
            const screens = ['screen-start', 'screen-round', 'screen-surprise', 'screen-conclusion'];
            screens.forEach(s => document.getElementById(s).classList.add('hidden'));
            screenTrans.classList.remove('hidden');
            
            currentCountdownValue = 5;
            document.getElementById('transition-timer').innerText = currentCountdownValue;
            playCommandBeep(false);

            if (transitionInterval) clearInterval(transitionInterval);
            transitionInterval = setInterval(() => {
                if (gamePaused) return;
                
                currentCountdownValue--;
                if (currentCountdownValue <= 0) {
                    clearInterval(transitionInterval);
                    playCommandBeep(true);
                    checkSurprise();
                } else {
                    playCommandBeep(false);
                    document.getElementById('transition-timer').innerText = currentCountdownValue;
                }
            }, 1000);
        }

        function manualPrev() {
            clearInterval(transitionInterval);
            clearInterval(analysisInterval);
            clearInterval(roundInterval);
            gamePaused = false;
            document.body.classList.remove('paused');
            
            if (currentRoundIndex > 0) {
                currentRoundIndex--;
                startTransition();
            } else {
                location.reload();
            }
        }

        function manualNext() {
            clearInterval(transitionInterval);
            checkSurprise();
        }

        function checkSurprise() {
            const round = ROUNDS[currentRoundIndex];
            if (round.surprise) {
                document.getElementById('screen-transition').classList.add('hidden');
                document.getElementById('screen-surprise').classList.remove('hidden');
                document.getElementById('surprise-msg').innerText = round.surprise.text;
                document.getElementById('surprise-icon-container').innerText = round.surprise.icon;
            } else {
                loadRound();
            }
        }

        function loadRound() {
            gameActive = true;
            const round = ROUNDS[currentRoundIndex];
            document.getElementById('screen-transition').classList.add('hidden');
            document.getElementById('screen-surprise').classList.add('hidden');
            document.getElementById('screen-round').classList.remove('hidden');
            
            document.getElementById('round-number').innerText = `PHASE: 0${currentRoundIndex + 1}`;
            document.getElementById('round-role').innerText = `ROLE: ${round.role}`;
            document.getElementById('scenario-text').innerText = round.scenario;
            
            renderChoices(round.choices);

            roundSeconds = 120;
            const timerEl = document.getElementById('round-timer');
            if (roundInterval) clearInterval(roundInterval);
            roundInterval = setInterval(() => {
                if (!gameActive || gamePaused || roundSeconds <= 0) return;
                roundSeconds--;
                timerEl.innerText = formatTime(roundSeconds);
            }, 1000);
        }

        function renderChoices(choices) {
            const container = document.getElementById('choices-container');
            container.innerHTML = '';
            choices.forEach(c => {
                const b = document.createElement('button');
                b.className = "w-full text-left p-6 border border-zinc-800 bg-zinc-900/40 hover:bg-red-600/10 hover:border-red-600 transition-all text-xl uppercase font-bold tracking-widest";
                b.innerHTML = `<span class="text-red-600 mr-4">[${c.id}]</span> ${c.text}`;
                b.onclick = () => showConsequence(c);
                container.appendChild(b);
            });
        }

        function showConsequence(choice) {
            const container = document.getElementById('choices-container');
            container.innerHTML = `
                <div class="p-8 border-2 border-red-600 bg-red-600/10 animate-pulse">
                    <h4 class="text-red-600 font-black uppercase text-sm mb-4">Immediate Consequences</h4>
                    <p class="text-2xl font-bold uppercase tracking-widest leading-tight italic">"${choice.consequence}"</p>
                    <div class="flex gap-4 mt-8">
                         <button onclick="backToChoices()" class="nav-btn">Undo Choice</button>
                         <button onclick="showAnalysis()" class="px-6 py-2 bg-red-600 text-white uppercase text-xs font-bold hover:bg-red-700">See Analysis</button>
                    </div>
                </div>
            `;
            playCommandBeep(true);
        }

        function backToChoices() {
            renderChoices(ROUNDS[currentRoundIndex].choices);
        }

        function backToConsequence() {
            clearInterval(analysisInterval);
            document.getElementById('analysis-container').classList.add('hidden');
        }

        function showAnalysis() {
            const round = ROUNDS[currentRoundIndex];
            const container = document.getElementById('analysis-container');
            document.getElementById('analysis-text').innerText = `"${round.analysis}"`;
            container.classList.remove('hidden');
            
            currentAnalysisValue = 20;
            const timerEl = document.querySelector('#analysis-timer span');
            timerEl.innerText = currentAnalysisValue;
            
            if (analysisInterval) clearInterval(analysisInterval);
            analysisInterval = setInterval(() => {
                if (gamePaused) return;
                
                currentAnalysisValue--;
                timerEl.innerText = currentAnalysisValue;
                if (currentAnalysisValue <= 0) nextRound();
            }, 1000);
        }

        function nextRound() {
            clearInterval(analysisInterval);
            document.getElementById('analysis-container').classList.add('hidden');
            currentRoundIndex++;
            if (currentRoundIndex < ROUNDS.length) startTransition();
            else finishGame();
        }

        function finishGame() {
            gameActive = false;
            clearInterval(musicLoop);
            clearInterval(globalInterval);
            document.getElementById('screen-round').classList.add('hidden');
            document.getElementById('ui-header').classList.add('hidden');
            document.getElementById('screen-conclusion').classList.remove('hidden');
        }

        // Global Key Listeners
        window.addEventListener('keydown', (e) => {
            if (e.key === 'f' || e.key === 'F') toggleFullScreen();
            if (e.code === 'Space') {
                e.preventDefault();
                togglePause();
            }
        });
    </script>
</body>
</html>
